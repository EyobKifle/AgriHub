<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><?php echo e($product['title'] ?? 'Product Details'); ?> - AgriHub</title>
    <link rel="stylesheet" href="../Css/header.css">
    <link rel="stylesheet" href="../Css/footer.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* Basic styles from guidance-detail.css, adapted for products */
        body { font-family: "Segoe UI", sans-serif; background-color: #FBF9F4; color: #1C1C1C; margin: 0; }
        .container { max-width: 960px; margin: 2rem auto; padding: 0 1rem; }
        .error-box { background-color: #f8d7da; color: #721c24; padding: 1rem; border: 1px solid #f5c6cb; border-radius: 8px; text-align: center; }
        .product-detail-layout { display: grid; grid-template-columns: 1fr; gap: 2rem; }
        @media (min-width: 768px) { .product-detail-layout { grid-template-columns: 1fr 1fr; } }

        /* Image Slider */
        .image-slider { position: relative; overflow: hidden; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); background-color: #eee; aspect-ratio: 4 / 3; }
        .slider-images { display: flex; transition: transform 0.5s ease-in-out; height: 100%; }
        .slider-images img { width: 100%; height: 100%; object-fit: cover; flex-shrink: 0; }
        .slider-nav { position: absolute; top: 50%; transform: translateY(-50%); background-color: rgba(0,0,0,0.4); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem; z-index: 10; }
        .slider-nav.prev { left: 10px; }
        .slider-nav.next { right: 10px; }
        .slider-nav:hover { background-color: rgba(0,0,0,0.7); }

        /* Product Info */
        .product-info { padding: 1rem 0; }
        .product-info h1 { font-size: 2rem; margin: 0 0 0.5rem; color: #1E4620; }
        .product-info .category { font-size: 0.9rem; color: #555; margin-bottom: 1rem; display: block; }
        .product-info .price { font-size: 1.75rem; font-weight: 700; color: #D97706; margin-bottom: 1rem; }
        .product-info .price .unit { font-size: 1rem; font-weight: 400; color: #555; }
        .product-info .stock { margin-bottom: 1.5rem; }
        .product-info .description { line-height: 1.6; }
        .seller-info { background-color: #fff; padding: 1rem; border: 1px solid #E5E7EB; border-radius: 8px; margin-top: 1.5rem; }
        .seller-info h3 { margin: 0 0 0.5rem; font-size: 1rem; }
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.75rem 1.5rem; border-radius: 8px; text-decoration: none; cursor: pointer; font-weight: 600; border: 1px solid transparent; }
        .btn-primary { background: #1E4620; color: #fff; }
        .btn-primary:hover { background: #2a632c; }
    </style>
</head>
<body>
    <div id="header-placeholder"></div>

    <main>
        <div class="container">
            <?php if ($error): ?>
                <div class="error-box"><?php echo e($error); ?></div>
            <?php else: ?>
                <div class="product-detail-layout">
                    <div class="image-slider-container">
                        <div class="image-slider">
                            <div class="slider-images">
                                <?php if (empty($images)): ?>
                                    <img src="../images/1.jpg" alt="Default product image">
                                <?php else: ?>
                                    <?php foreach ($images as $img): ?>
                                        <img src="../<?php echo e($img); ?>" alt="<?php echo e($product['title']); ?>">
                                    <?php endforeach; ?>
                                <?php endif; ?>
                            </div>
                            <?php if (count($images) > 1): ?>
                                <button class="slider-nav prev" onclick="moveSlide(-1)">&#10094;</button>
                                <button class="slider-nav next" onclick="moveSlide(1)">&#10095;</button>
                            <?php endif; ?>
                        </div>
                    </div>

                    <div class="product-info">
                        <span class="category"><?php echo e($product['category_name']); ?></span>
                        <h1><?php echo e($product['title']); ?></h1>
                        <p class="price"><?php echo number_format($product['price'], 2); ?> ETB <span class="unit">/ <?php echo e($product['unit']); ?></span></p>
                        <p class="stock"><strong><?php echo e($product['quantity_available']); ?> <?php echo e($product['unit']); ?></strong> available</p>
                        
                        <div class="description">
                            <h3>Product Description</h3>
                            <p><?php echo nl2br(e($product['description'])); ?></p>
                        </div>

                        <div class="seller-info">
                            <h3>Seller Information</h3>
                            <p>
                                <strong><?php echo e($product['business_name'] ?: $product['seller_name']); ?></strong><br>
                                <i class="fa-solid fa-location-dot"></i> <?php echo e($product['seller_location']); ?>
                            </p>
                        </div>

                        <div style="margin-top: 2rem;">
                            <button class="btn btn-primary" onclick="alert('Add to cart functionality to be implemented.')">
                                <i class="fas fa-shopping-cart"></i> Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            <?php endif; ?>
        </div>
    </main>

    <div id="footer-placeholder"></div>

    <script type="module" src="../Js/site.js"></script>
    <script src="../Js/view-product.js"></script>
</body>
</html>
